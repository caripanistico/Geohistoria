(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{118:function(e,t,a){},137:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(18),r=a.n(c),i=(a(93),a(12)),l=a.n(i),o=a(23),h=a(8),u=a(9),m=a(11),d=a(10),j=a(22),b=a(6),p="https://geohistoria.herokuapp.com/",O=a(44),g=a(43),x=a(0),f=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"style",value:function(e,t){return{left:e,top:t}}},{key:"render",value:function(){var e=this.props.hecho;return Object(x.jsx)("div",{children:Object(x.jsx)(j.b,{to:"/hecho",children:Object(x.jsx)("span",{className:"tooltiptext",children:Object(x.jsx)("button",{id:e._id,type:"button",className:"botonm",style:this.style(0,0),onClick:this.props.mostrarHecho.bind(this,e),children:Object(x.jsx)("span",{className:"tooltiptext",children:e.title})})})})})}}]),a}(n.Component),v=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(h.a)(this,a),null!=e&&(n=t.call(this,e)),Object(g.a)(n)}return Object(u.a)(a,[{key:"render",value:function(){return Object(x.jsx)(f,{hecho:this.props.hecho,mostrarHecho:this.props.mostrarHecho},this.props.hecho._id)}}]),a}(n.Component),y=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return Object(x.jsx)("div",{style:{height:"100vh"},children:Object(x.jsx)(O.a,{center:{lat:Number(this.props.lat),lng:Number(this.props.lng)},zoom:this.props.zoom,children:this.props.hechos.map((function(t){return Object(x.jsx)(v,{id:t._id,lat:t.x,lng:t.y,hecho:t,mostrarHecho:e.props.mostrarHecho})}))})})}}]),a}(n.Component);y.defaultProps={center:{lat:-36.8260421,lng:-73.0330456},zoom:12};var N=y,k=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={selectedImg:e.images[0],images:e.images},n}return Object(u.a)(a,[{key:"setSelectedImg",value:function(e){this.setState({selectedImg:e})}},{key:"render",value:function(){var e=this;return Object(x.jsx)("div",{className:"Imagenes",children:Object(x.jsxs)("div",{className:"container",children:[Object(x.jsx)("img",{src:p+"imagen?filename="+this.state.selectedImg,alt:"Selected",className:"selected"}),Object(x.jsx)("div",{className:"imgContainer",children:this.state.images.map((function(t,a){return Object(x.jsx)("img",{style:{border:e.state.selectedImg===t?"4px solid black":""},src:p+"imagen?filename="+t,alt:"imagen",onClick:function(){return e.setSelectedImg(t)}},a)}))})]})})}}]),a}(n.Component),C=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.hecho;return console.log(e),Object(x.jsxs)(n.Fragment,{children:[Object(x.jsxs)("head",{children:[Object(x.jsx)("meta",{charSet:"UTF-8"}),Object(x.jsx)("meta",{httpEquiv:"X-UA-Compatible",content:"IE=edge"}),Object(x.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),Object(x.jsx)("title",{children:"Archivo"}),Object(x.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Montserrat&family=Open+Sans&display=swap",rel:"stylesheet"}),Object(x.jsx)("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/glider-js@1.7.7/glider.min.css"}),Object(x.jsx)("link",{rel:"stylesheet",href:"styles/home.css"})]}),Object(x.jsxs)("div",{children:[Object(x.jsx)("section",{class:"seccion",children:Object(x.jsx)("h1",{children:e.nimage1})}),Object(x.jsx)(k,{images:e.imagenes}),Object(x.jsxs)("aside",{class:"columna",children:[Object(x.jsx)("h1",{id:"title",children:e.title}),Object(x.jsx)("div",{children:Object(x.jsx)("p",{children:e.texto})})]}),Object(x.jsx)("footer",{class:"pie"}),Object(x.jsx)("script",{src:"https://kit.fontawesome.com/2c36e9b7b1.js",crossOrigin:"anonymous"}),Object(x.jsx)("script",{src:"https://cdn.jsdelivr.net/npm/glider-js@1.7.7/glider.min.js"}),Object(x.jsx)("script",{src:"app.js"})]})]})}}]),a}(n.Component),E=a(88),L=(a(103),a(104),a(84)),S=function(e){var t=e.onChange,a=e.date1,s=e.date2,c=Object(n.useState)([{startDate:new Date(a,0,1),endDate:new Date(s,11,31),key:"selection"}]),r=Object(E.a)(c,2),i=r[0],l=r[1];return Object(x.jsx)(L.DateRangePicker,{onChange:function(e){var a=e.selection;t(a),l([a])},showSelectionPreview:!0,moveRangeOnFirstSelection:!1,months:2,ranges:i,direction:"horizontal",minDate:new Date(1800,0,1),maxDate:new Date(2040,11,31)})},w=[{title:"Concepci\xf3n",url:"#",cName:"nav-links",commune:"concepcion",lat:"-36.8260421",lng:"-73.0330456"},{title:"Talcahuano",url:"#",cName:"nav-links",commune:"talcahuano",lat:"-36.7305321",lng:"-73.1070265"},{title:"Penco",url:"#",cName:"nav-links",commune:"penco",lat:"-36.7379755",lng:"-72.9940383"},{title:"Tom\xe9",url:"#",cName:"nav-links",commune:"tome",lat:"-36.6181695",lng:"-72.9552698"},{title:"Florida",url:"#",cName:"nav-links",commune:"florida",lat:"-36.816667",lng:"-72.666667"},{title:"Hualp\xe9n",url:"#",cName:"nav-links",commune:"hualpen",lat:"-36.783333",lng:"-73.083333"},{title:"Hualqui",url:"#",cName:"nav-links",commune:"hualqui",lat:"-36.9759",lng:"-72.9384"},{title:"Santa Juana",url:"#",cName:"nav-links",commune:"santajuana",lat:"-37.166667",lng:"-72.933333"},{title:"Lota",url:"#",cName:"nav-links",commune:"lota",lat:"-37.0944",lng:"-73.1563"},{title:"Coronel",url:"#",cName:"nav-links",commune:"coronel",lat:"-37.016667",lng:"-73.133333"},{title:"San Pedro de la Paz",url:"#",cName:"nav-links",commune:"sanpedrodelapaz",lat:"-36.84082",lng:"-73.10311"},{title:"Chiguayante",url:"#",cName:"nav-links",commune:"chiguayante",lat:"-36.916667",lng:"-73.016667"}],D=(a(118),a(70),function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={clicked:!1},e.handleClick=function(){e.setState({clicked:!e.state.clicked})},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return Object(x.jsxs)("nav",{className:"NavbarItems",children:[Object(x.jsxs)("h1",{className:"navbar-logo",children:["Geohistoria",Object(x.jsx)("i",{className:"fab fa-react"})]}),Object(x.jsx)("div",{className:"menu-icon",onClick:this.handleClick,children:Object(x.jsx)("i",{className:this.state.clicked?"fas fa-times":"fas fa-bars"})}),Object(x.jsx)("ul",{className:this.state.clicked?"nav-menu active":"nav-menu",children:w.map((function(t,a){return Object(x.jsx)("li",{children:Object(x.jsx)("a",{className:t.cName,onClick:function(){e.props.setLat(t.lat),e.props.setLng(t.lng),e.props.setCommune(t.commune)},children:t.title})},a)}))}),Object(x.jsx)(j.b,{to:"/ingreso",children:Object(x.jsx)("button",{type:"button",className:"botoni",children:"Ingresar hecho"})})]})}}]),a}(n.Component)),I=a(85),H=a(86),A=a(29),F=a(58),M=a.n(F),_=a(87),z=a.n(_),B=a(73).default,P={titleError:"",descriptionError:"",yearError:"",communeError:"",imagenError:"",hayfotos:!1},T=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).validate=function(){var e="",t="",a="",s="",c="";return n.state.title||(e="Este campo es obligatorio."),n.state.description||(t="Este campo es obligatorio."),n.state.year?Number(n.state.year)||(a="Ingrese un n\xfamero v\xe1lido."):a="Este campo es obligatorio.",(n.state.year>2021||n.state.year<0)&&(a="A\xf1o inv\xe1lido."),n.state.commune||(s="Este campo es obligatorio."),n.hayfotos||(c="Este campo es obligatorio."),e||t||a||s||c?(n.setState({titleError:e}),n.setState({descriptionError:t}),n.setState({yearError:a}),n.setState({communeError:s}),n.setState({imagenError:c}),!1):(n.state.title&&n.state.description&&n.state.year&&n.state.commune&&n.hayfotos&&z()("Hecho publicado correctamente"),!0)},n.setLat=function(e){n.setState({lat:e})},n.setLng=function(e){n.setState({lng:e})},n.state={lat:-36.8260421,lng:-73.0330456,titleError:"",descriptionError:"",yearError:"",communeError:"",imagenError:""},n.handleChange=n.handleChange.bind(Object(A.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(A.a)(n)),n.handleEdit=n.handleEdit.bind(Object(A.a)(n)),n}return Object(u.a)(a,[{key:"handleLoaded",value:function(e,t){var a=this;e.addListener("click",(function(n){return a.handleClick(n,e,t)}),!1)}},{key:"handleSubmit",value:function(){var e=Object(o.a)(l.a.mark((function e(t){var a,n,s,c,r,i,o,h,u,m,d,j,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),this.validate()&&this.setState(P),console.log(this.state),a=new M.a,n=document.querySelector("#imagenes"),s=Object(H.a)(n.files);try{for(s.s();!(c=s.n()).done;)r=c.value,i=r.name.split(".").pop(),o=r.slice(0,r.size,"image/png"),h=Date.now()+Math.random().toString(20).substr(2,6)+"."+i,u=new File([o],h,{type:"image/png"}),this.hayfotos=!0,"",this.setState({imagenError:""}),console.log(h,u),a.append(h,u)}catch(l){s.e(l)}finally{s.f()}return e.next=10,B.post(p+"add-image",a,{headers:{"Content-Type":"multipart/form-data"}});case 10:for(b in m=e.sent,d=m.data.imagenes,j=new M.a,this.state)j.append(b,this.state[b]);return j.append("imagenes",d),e.next=17,B.post(p+"add-point",j);case 17:m=e.sent,console.log(m);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleClick",value:function(e,t,a){var n=this,s=e.latLng.lat(),c=e.latLng.lng();if(this.setLat(s),this.setLng(c),this.pin)this.pin.setPosition(e.latLng);else{var r=new a.Marker({position:e.latLng,map:t,title:"Click to remove"});r.addListener("click",(function(){r.setMap(null),n.pin=void 0}),!1),this.pin=r}}},{key:"handleChange",value:function(e){var t=e.target,a=t.value,n=t.name,s=Number(a);(""!==a||"lat"!==n&&"lng"!==n)&&("lat"===n?isNaN(s)||s===this.state.lat||this.setLat(s):"lng"===n?isNaN(s)||s===this.state.lng||this.setLng(s):this.setState(Object(I.a)({},n,a)),"lat"!==t.name&&"lng"!==t.name||(t.value=""))}},{key:"handleEdit",value:function(e){"lat"===e.target.name?e.target.value=this.state.lat:e.target.value=this.state.lng}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return Object(x.jsx)("div",{className:"fondoo",children:Object(x.jsx)(n.Fragment,{children:Object(x.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(x.jsx)("header",{className:"header",children:Object(x.jsx)("h1",{style:{color:"white"},children:"FORMULARIO DE COLABORACI\xd3N"})}),Object(x.jsxs)("section",{className:"seccion2",children:[Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{className:"label",for:"imagenes",children:"Imagenes: "}),Object(x.jsx)("input",{style:{border:"none"},className:"input",type:"file",name:"imagenes",id:"imagenes",multiple:!0}),Object(x.jsxs)("div",{style:{marginLeft:"20px"},className:"error",children:[this.state.imagenError?Object(x.jsx)("i",{class:"fas fa-exclamation-circle"}):null,this.state.imagenError]})]}),Object(x.jsx)("div",{style:{height:"40vh",width:"98%",marginLeft:"10px"},children:Object(x.jsx)(O.a,{yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:function(t){var a=t.map,n=t.maps;return e.handleLoaded(a,n)},center:{lat:Number(this.state.lat),lng:Number(this.state.lng)},zoom:11})}),Object(x.jsxs)("div",{className:"LatLong",children:[Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{className:"label",for:"lat",children:"Latitud:"}),Object(x.jsx)("input",{className:"input",type:"text",name:"lat",id:"formLat",autocomplete:"off",placeholder:this.state.lat,onClick:this.handleEdit,onBlur:this.handleChange})]}),Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{className:"label",for:"lng",children:"Longitud:"}),Object(x.jsx)("input",{className:"input",type:"text",name:"lng",id:"formLng",autocomplete:"off",placeholder:this.state.lng,onClick:this.handleEdit,onBlur:this.handleChange})]})]}),Object(x.jsxs)("p",{className:"aviso",children:[Object(x.jsx)("i",{class:"fas fa-exclamation-triangle"}),"Procura seleccionar una ubicaci\xf3n en el mapa. de lo contrario el hecho se posicionar\xe1 por defecto en el centro de Concepci\xf3n."]})]}),Object(x.jsxs)("aside",{className:"columna2",children:[Object(x.jsx)("div",{className:"LatLong",style:{marginLeft:"-40px",textAlign:"center"},children:Object(x.jsx)(b.a,{exact:!0,path:"/ingreso",render:function(){return Object(x.jsxs)("div",{children:[Object(x.jsx)(j.b,{to:"/",children:Object(x.jsx)("button",{type:"button",className:"botonv2",children:"Volver"})}),Object(x.jsx)("input",{className:"botonSubmit",value:"Submit",type:"submit"})]})}})}),Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{className:"label",for:"title",children:"T\xedtulo:"}),Object(x.jsx)("input",{className:"input",type:"text",name:"title",id:"title",onBlur:this.handleChange}),Object(x.jsxs)("div",{className:"error",children:[this.state.titleError?Object(x.jsx)("i",{class:"fas fa-exclamation-circle"}):null,this.state.titleError]})]}),Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{className:"label",for:"description",children:"Descripci\xf3n:"}),Object(x.jsx)("textarea",{className:"textarea",type:"text",name:"description",id:"description",onBlur:this.handleChange}),Object(x.jsxs)("div",{className:"error",children:[this.state.descriptionError?Object(x.jsx)("i",{class:"fas fa-exclamation-circle"}):null,this.state.descriptionError]})]}),Object(x.jsxs)("div",{className:"LatLong",style:{width:"95%"},children:[Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{className:"label",for:"year",children:"A\xf1o:"}),Object(x.jsx)("input",{className:"input",type:"text",name:"year",id:"year",onBlur:this.handleChange}),Object(x.jsxs)("div",{className:"error",children:[this.state.yearError?Object(x.jsx)("i",{class:"fas fa-exclamation-circle"}):null,this.state.yearError]})]}),Object(x.jsxs)("p",{children:[Object(x.jsx)("label",{className:"label",for:"commune",children:"Comuna:"}),Object(x.jsx)("input",{className:"input",type:"text",name:"commune",id:"commune",onBlur:this.handleChange}),Object(x.jsxs)("div",{className:"error",children:[this.state.communeError?Object(x.jsx)("i",{class:"fas fa-exclamation-circle"}):null,this.state.communeError]})]})]})]})]})})})}}]),a}(n.Component),R=a(73).default,q=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).setLat=function(e){n.setState({lat:e})},n.setLng=function(e){n.setState({lng:e})},n.setCommune=function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({commune:t}),e.prev=1,e.next=4,n.obtener_puntos(t,n.state.date1,n.state.date2);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),n.mostrarHecho=function(e){n.setState({hecho:e})},n.ocultarHecho=function(){n.setState({hecho:""})},n.obtener_puntos=function(){var e=Object(o.a)(l.a.mark((function e(t,a,s){var c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={commune:t,date1:a,date2:s},console.log(c),e.next=4,R.get(p.concat("/date-range"),{params:c});case 4:r=e.sent,n.setState({hechos:r.data,date1:a,date2:s});case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),n.onChange_Dates=function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({date1:t.startDate.getFullYear(),date2:t.endDate.getFullYear()}),e.prev=1,e.next=4,n.obtener_puntos(n.state.commune,t.startDate.getFullYear(),t.endDate.getFullYear());case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),alert("back-end no responde !!");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),n.state={hechos:null,hecho:"",date1:1900,date2:2e3,lat:-36.8260421,lng:-73.0330456,commune:"concepcion"},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.title="GeoHistoria",e.prev=1,e.next=4,this.obtener_puntos(this.state.commune,this.state.date1,this.state.date2);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return null==this.state.hechos?Object(x.jsx)("div",{children:Object(x.jsx)("h1",{children:" Cargando... "})}):Object(x.jsx)("div",{children:Object(x.jsxs)(j.a,{children:[Object(x.jsx)(b.a,{exact:!0,path:"/",render:function(){return Object(x.jsxs)("div",{id:"container",children:[Object(x.jsx)(D,{setLat:e.setLat,setLng:e.setLng,setCommune:e.setCommune}),Object(x.jsx)(S,{date1:e.state.date1,date2:e.state.date2,onChange:e.onChange_Dates}),Object(x.jsx)(N,{id:"google_map",hechos:e.state.hechos,mostrarHecho:e.mostrarHecho,lat:e.state.lat,lng:e.state.lng})]})}}),Object(x.jsx)(b.a,{exact:!0,path:"/hecho",render:function(){return Object(x.jsxs)("div",{children:[Object(x.jsx)("nav",{class:"menu",children:Object(x.jsx)(j.b,{to:"/",children:Object(x.jsx)("button",{type:"button",className:"botonv",children:"Volver"})})}),Object(x.jsx)("section",{children:Object(x.jsx)(C,{hecho:e.state.hecho})})]})}}),Object(x.jsx)(b.a,{exact:!0,path:"/ingreso",render:function(){return Object(x.jsx)(T,{lat:e.state.lat,lng:e.state.lng})}})]})})}}]),a}(n.Component);r.a.render(Object(x.jsx)(s.a.StrictMode,{children:Object(x.jsx)(q,{})}),document.getElementById("root"))},70:function(e,t,a){},93:function(e,t,a){}},[[137,1,2]]]);
//# sourceMappingURL=main.9ff3d888.chunk.js.map